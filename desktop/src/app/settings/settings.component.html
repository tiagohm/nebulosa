<div class="grid p-2 relative">
    <p-tabView class="w-full">
        <p-tabPanel header="Location" leftIcon="mdi mdi-map-marker">
            <div class="flex gap-3 p-3">
                <span class="p-float-label min-w-16rem">
                    <p-dropdown [options]="locations" [(ngModel)]="location" (ngModelChange)="locationChanged()"
                                optionLabel="name" dataKey="id" styleClass="p-inputtext-sm border-0" emptyMessage="No location found"
                                [autoDisplayFirst]="false" />
                    <label>Location</label>
                </span>
                <div class="flex gap-1">
                    <p-button (onClick)="addLocation()" icon="mdi mdi-plus" size="small" severity="success" />
                    <p-button (onClick)="editLocation()" icon="mdi mdi-pencil" size="small" severity="info" />
                    <p-button [disabled]="locations.length <= 1" (onClick)="deleteLocation()" icon="mdi mdi-delete"
                              size="small" severity="danger" />
                </div>
            </div>
        </p-tabPanel>
        <p-tabPanel header="Plate Solver" leftIcon="mdi mdi-sigma">
            <div class="flex flex-wrap gap-3 p-3">
                <span class="p-float-label min-w-16rem">
                    <p-dropdown [options]="['ASTAP', 'ASTROMETRY_NET_ONLINE']" [(ngModel)]="solverType" styleClass="p-inputtext-sm border-0"
                                (ngModelChange)="solvers.get(solverType)!.type = $event; save()" [autoDisplayFirst]="false" />
                    <label>Type</label>
                </span>
                <span class="p-float-label max-w-12rem">
                    <p-inputNumber styleClass="p-inputtext-sm border-0 w-full"
                                   [ngModel]="solvers.get(solverType)!.downsampleFactor"
                                   (ngModelChange)="solvers.get(solverType)!.downsampleFactor = $event; save()" [showButtons]="true"
                                   [min]="0" [max]="4" scrollableNumber />
                    <label>Downsample factor</label>
                </span>
                <span class="p-float-label max-w-9rem">
                    <p-inputNumber styleClass="p-inputtext-sm border-0 w-full" [ngModel]="solvers.get(solverType)!.timeout"
                                   (ngModelChange)="solvers.get(solverType)!.timeout = $event; save()" [showButtons]="true"
                                   [min]="0" [max]="300" scrollableNumber />
                    <label>Timeout (s)</label>
                </span>
                <span class="flex gap-1 align-items-center" *ngIf="solverType === 'ASTAP'">
                    <span class="w-full p-float-label min-w-16rem">
                        <input pInputText class="p-inputtext-sm border-0 w-full" [ngModel]="solvers.get(solverType)!.executablePath"
                               (ngModelChange)="solvers.get(solverType)!.executablePath = $event; save()" />
                        <label>Executable path</label>
                    </span>
                    <p-button icon="mdi mdi-folder-open" size="small" (onClick)="chooseExecutablePathForPlateSolver()" />
                </span>
                <span class="p-float-label min-w-16rem" *ngIf="solverType === 'ASTROMETRY_NET_ONLINE'">
                    <input pInputText class="p-inputtext-sm border-0 w-full" [ngModel]="solvers.get(solverType)!.apiUrl"
                           (ngModelChange)="solvers.get(solverType)!.apiUrl = $event; save()" />
                    <label>API URL</label>
                </span>
                <span class="p-float-label" *ngIf="solverType === 'ASTROMETRY_NET_ONLINE'">
                    <input pInputText class="p-inputtext-sm border-0 w-full" [ngModel]="solvers.get(solverType)!.apiKey"
                           (ngModelChange)="solvers.get(solverType)!.apiKey = $event; save()" />
                    <label>API Key</label>
                </span>
            </div>
        </p-tabPanel>
        <p-tabPanel header="Star Detection" leftIcon="mdi mdi-star">
            <div class="flex flex-wrap gap-3 p-3">
                <span class="p-float-label min-w-16rem">
                    <p-dropdown [options]="['ASTAP']" [(ngModel)]="starDetectorType" styleClass="p-inputtext-sm border-0"
                                (ngModelChange)="starDetectors.get(starDetectorType)!.type = $event; save()" [autoDisplayFirst]="false" />
                    <label>Type</label>
                </span>
                <span class="p-float-label max-w-9rem">
                    <p-inputNumber styleClass="p-inputtext-sm border-0 w-full" [ngModel]="starDetectors.get(starDetectorType)!.timeout"
                                   (ngModelChange)="starDetectors.get(starDetectorType)!.timeout = $event; save()" [showButtons]="true"
                                   [min]="0" [max]="300" scrollableNumber />
                    <label>Timeout (s)</label>
                </span>
                <span class="flex gap-1 align-items-center" *ngIf="starDetectorType === 'ASTAP'">
                    <span class="w-full p-float-label min-w-16rem">
                        <input pInputText class="p-inputtext-sm border-0 w-full" [ngModel]="starDetectors.get(starDetectorType)!.executablePath"
                               (ngModelChange)="starDetectors.get(starDetectorType)!.executablePath = $event; save()" />
                        <label>Executable path</label>
                    </span>
                    <p-button icon="mdi mdi-folder-open" size="small" (onClick)="chooseExecutablePathForStarDetection()" />
                </span>
            </div>
        </p-tabPanel>
    </p-tabView>
</div>