<div class="container p-4">
    <div class="grid py-1 flex align-items-center">
        <div class="col-8">
            <span class="p-float-label">
                <p-dropdown [disabled]="moving" [options]="filterWheels" [(ngModel)]="filterWheel" optionLabel="name"
                            (ngModelChange)="filterWheelChanged()"
                            styleClass="border-0" emptyMessage="No filter wheel found" />
                <label>Filter Wheel</label>
            </span>
        </div>
        <div class="col-2 flex align-items-center gap-1">
            <p-button *ngIf="connected" [disabled]="!filterWheel || moving" (onClick)="connect()" icon="mdi mdi-close"
                      styleClass="p-button-danger" />
            <p-button *ngIf="!connected" [disabled]="!filterWheel || moving" (onClick)="connect()" icon="mdi mdi-connection"
                      styleClass="p-button-info" />
        </div>
        <div class="col-12 pt-0 text-sm text-gray-400 flex align-items-center my-1 gap-1">
            <i class="mdi mdi-information text-blue-600"></i>
            <span style="display: contents">{{ moving ? 'moving' : 'idle' }}</span>
        </div>
    </div>
    <div class="grid">
        <div class="col-3">
            <span class="p-float-label">
                <p-inputNumber [readonly]="true" styleClass="border-0 w-full" [(ngModel)]="position" locale="en" />
                <label>Position</label>
            </span>
        </div>
        <div class="col-9">
            <span class="p-float-label">
                <p-dropdown [disabled]="moving" [options]="filters" [autoDisplayFirst]="false" [(ngModel)]="selectedFilter" styleClass="border-0"
                            emptyMessage="No filter found" scrollHeight="128px">
                    <ng-template let-item pTemplate="selectedItem">
                        <div class="flex flex-row align-items-center justify-content-between">
                            <span>{{ item.name }}</span>
                            <i [class.invisible]="!item.dark" class="mdi mdi-camera-iris"></i>
                        </div>
                    </ng-template>
                    <ng-template let-item pTemplate="item">
                        <div stopPropagation [spEnabled]="item.editing" class="flex flex-row align-items-center justify-content-between">
                            <p-inplace #filterItem [preventClick]="true" [closable]="false" [active]="item.editing">
                                <ng-template pTemplate="display">
                                    <span>{{ item.name }}</span>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <input type="text" [(ngModel)]="item.newName" pInputText [maxLength]="16" />
                                </ng-template>
                            </p-inplace>
                            <span class="flex flex-row align-items-center gap-2">
                                <p-button *ngIf="!item.editing" icon="mdi mdi-pencil" (onClick)="filterItem.activate(); showFilterEdit(item, $event)"
                                          pTooltip="Rename" tooltipPosition="bottom" styleClass="p-button-info p-button-text" />
                                <p-button *ngIf="item.editing" [disabled]="!item.newName" icon="mdi mdi-check"
                                          (onClick)="filterItem.deactivate(); applyFilterName(item, $event)"
                                          styleClass="p-button-success p-button-text" />
                                <p-checkbox [(ngModel)]="item.dark" [binary]="true" pTooltip="Shutter" tooltipPosition="bottom"
                                            (onChange)="shutterToggled(item, $event)" />
                            </span>
                        </div>
                    </ng-template>
                </p-dropdown>
                <label>Filter</label>
            </span>
        </div>
    </div>
</div>