<div class="container px-4 py-3">
    <div class="grid">
        <div class="col-6">
            <div class="grid">
                <div class="col-12 align-items-center gap-2">
                    <span class="p-float-label device">
                        <p-dropdown [disabled]="darvInProgress" [options]="cameras" [(ngModel)]="camera" optionLabel="name"
                                    (ngModelChange)="cameraChanged()" styleClass="p-inputtext-sm border-0" emptyMessage="No camera found" />
                        <label>Camera</label>
                    </span>
                    <p-button *ngIf="cameraConnected" [disabled]="!camera || darvInProgress" (onClick)="cameraConnect()" icon="mdi mdi-close"
                              size="small" severity="danger" pTooltip="Disconnect" tooltipPosition="bottom" />
                    <p-button *ngIf="!cameraConnected" [disabled]="!camera || darvInProgress" (onClick)="cameraConnect()" icon="mdi mdi-connection"
                              size="small" severity="info" pTooltip="Connect" tooltipPosition="bottom" />
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="grid">
                <div class="col-12 align-items-center gap-2">
                    <span class="p-float-label device">
                        <p-dropdown [disabled]="darvInProgress" [options]="guideOutputs" [(ngModel)]="guideOutput" optionLabel="name"
                                    (ngModelChange)="guideOutputChanged()" styleClass="p-inputtext-sm border-0"
                                    emptyMessage="No guide output found" />
                        <label>Guide Output</label>
                    </span>
                    <p-button *ngIf="guideOutputConnected" [disabled]="!guideOutput || darvInProgress" (onClick)="guideOutputConnect()"
                              icon="mdi mdi-close" size="small" severity="danger" pTooltip="Disconnect" tooltipPosition="bottom" />
                    <p-button *ngIf="!guideOutputConnected" [disabled]="!guideOutput || darvInProgress" (onClick)="guideOutputConnect()"
                              icon="mdi mdi-connection" size="small" severity="info" pTooltip="Connect" tooltipPosition="bottom" />
                </div>
            </div>
        </div>
        <div class="col-12 pt-0 text-sm text-gray-400 flex align-items-center my-1 gap-1 text-sm" style="min-height: 25px;">
            <i class="mdi mdi-information text-blue-600"></i>
            <span style="min-width: 60px" class="text-left mr-2">{{ darvStatus | enum | lowercase }}</span>
            <ng-container *ngIf="darvInProgress">
                <span *ngIf="darvDirection" class="bg-purple-500 border-round-md p-1 text-gray-900" style="min-width: 44px">
                    {{ darvDirection }}
                </span>
                <span class="bg-green-500 border-round-md p-1 text-gray-900" style="min-width: 50px">
                    {{ darvRemainingTime | exposureTime }}
                </span>
                <span class="bg-green-500 border-round-md p-1 text-gray-900" style="min-width: 40px">
                    {{ darvProgress | percent:'1.1-1' }}
                </span>
            </ng-container>
        </div>
    </div>
    <div class="grid">
        <div class="col-12">
            <p-tabView>
                <p-tabPanel header="DARV">
                    <div class="grid mt-2">
                        <div class="col-4">
                            <span class="p-float-label">
                                <p-inputNumber styleClass="p-inputtext-sm border-0 max-w-full" [(ngModel)]="darvInitialPause" [showButtons]="true"
                                               [min]="1" [max]="60" />
                                <label>Initial pause (s)</label>
                            </span>
                        </div>
                        <div class="col-4">
                            <span class="p-float-label">
                                <p-inputNumber styleClass="p-inputtext-sm border-0 max-w-full" [(ngModel)]="darvDrift" [showButtons]="true" [min]="1"
                                               [max]="600" />
                                <label>Drift for (s)</label>
                            </span>
                        </div>
                        <div class="col-4">
                            <span class="p-float-label">
                                <p-dropdown [options]="darvHemispheres" [(ngModel)]="darvHemisphere" styleClass="p-inputtext-sm border-0"
                                            [autoDisplayFirst]="false" />
                                <label>Hemisphere</label>
                            </span>
                        </div>
                    </div>
                    <div class="grid mt-1">
                        <div class="col-12 flex align-items-center justify-content-center gap-1">
                            <p-button [disabled]="!cameraConnected || !guideOutputConnected || darvInProgress" label="Azimuth"
                                      (onClick)="darvAzimuth()" icon="mdi mdi-arrow-left-right-bold" severity="success" />
                            <p-button [disabled]="!cameraConnected || !guideOutputConnected || darvInProgress" label="Altitude"
                                      (onClick)="darvAltitude()" icon="mdi mdi-arrow-up-down-bold" severity="success" />
                            <p-button [disabled]="!cameraConnected || !guideOutputConnected || !darvInProgress" label="Abort" (onClick)="darvStop()"
                                      icon="mdi mdi-stop" severity="danger" />
                            <p-button [disabled]="!cameraConnected" (onClick)="openCameraImage()" icon="mdi mdi-image" [text]="true" styleClass="ml-4"
                                      pTooltip="View image" tooltipPosition="bottom" />
                        </div>
                    </div>
                </p-tabPanel>
            </p-tabView>
        </div>
    </div>
</div>