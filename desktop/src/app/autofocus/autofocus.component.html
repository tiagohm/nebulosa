<div class="grid p-4">
    <div class="col-12 align-items-center justify-content-center gap-2">
        <neb-device-chooser title="CAMERA" icon="mdi mdi-camera-iris" [devices]="cameras" [(device)]="camera"
                            (deviceChange)="cameraChanged()" />
        <p-button [disabled]="!camera.name || running" icon="mdi mdi-cog" (onClick)="showCameraDialog()" size="small" />
        <neb-device-chooser title="FOCUSER" icon="mdi mdi-target" [devices]="focusers" [(device)]="focuser"
                            (deviceChange)="focuserChanged()" />
    </div>
    <div class="col-12 mt-3">
        <div class="grid">
            <div class="col-4 align-items-center">
                <span class="p-float-label">
                    <p-inputNumber [disabled]="!focuser.connected" styleClass="p-inputtext-sm border-0 max-w-full" [(ngModel)]="request.stepSize"
                                   [showButtons]="true" [min]="1" [max]="focuser.maxPosition" (ngModelChange)="savePreference()" scrollableNumber />
                    <label>Step Size</label>
                </span>
            </div>
            <div class="col-5 align-items-center">
                <span class="p-float-label">
                    <p-inputNumber [disabled]="!focuser.connected" styleClass="p-inputtext-sm border-0 max-w-full"
                                   [(ngModel)]="request.initialOffsetSteps" [showButtons]="true" [min]="1" [max]="1000"
                                   (ngModelChange)="savePreference()" scrollableNumber />
                    <label>Initial Offset Steps ({{ request.initialOffsetSteps * request.stepSize }})</label>
                </span>
            </div>
            <div class="col-3 align-items-center">
                <span class="p-float-label">
                    <p-inputNumber styleClass="p-inputtext-sm border-0 max-w-full" [(ngModel)]="request.totalNumberOfAttempts"
                                   [showButtons]="true" [min]="1" [max]="10" (ngModelChange)="savePreference()" scrollableNumber />
                    <label>Attempts</label>
                </span>
            </div>
            <div class="col-7 align-items-center">
                <span class="p-float-label">
                    <p-dropdown [options]="['TRENDLINES', 'PARABOLIC', 'TREND_PARABOLIC', 'HYPERBOLIC', 'TREND_HYPERBOLIC']"
                                [(ngModel)]="request.fittingMode" [autoDisplayFirst]="false" styleClass="p-inputtext-sm border-0"
                                (ngModelChange)="savePreference()" />
                    <label>Curve Fitting</label>
                </span>
            </div>
            <div class="col-5 align-items-center">
                <span class="p-float-label">
                    <p-dropdown [options]="['ASTAP']" [(ngModel)]="request.starDetector.type" [autoDisplayFirst]="false"
                                styleClass="p-inputtext-sm border-0" (ngModelChange)="savePreference()" />
                    <label>Star Detector</label>
                </span>
            </div>
            <div class="col-10">
                <div class="grid">
                    <div class="col-6 align-items-center">
                        <span class="p-float-label">
                            <p-dropdown [options]="['NONE', 'ABSOLUTE', 'OVERSHOOT']"
                                        [(ngModel)]="request.backlashCompensation.mode" [autoDisplayFirst]="false"
                                        styleClass="p-inputtext-sm border-0"
                                        (ngModelChange)="savePreference()" />
                            <label>Backlash Compensation</label>
                        </span>
                    </div>
                    <div class="col-3 align-items-center">
                        <span class="p-float-label">
                            <p-inputNumber [disabled]="request.backlashCompensation.mode === 'NONE'" styleClass="p-inputtext-sm border-0 max-w-full"
                                           [(ngModel)]="request.backlashCompensation.backlashIn" [showButtons]="true" [min]="1" [max]="1000"
                                           (ngModelChange)="savePreference()" scrollableNumber />
                            <label>In</label>
                        </span>
                    </div>
                    <div class="col-3 align-items-center">
                        <span class="p-float-label">
                            <p-inputNumber [disabled]="request.backlashCompensation.mode === 'NONE'" styleClass="p-inputtext-sm border-0 max-w-full"
                                           [(ngModel)]="request.backlashCompensation.backlashOut" [showButtons]="true" [min]="1" [max]="1000"
                                           (ngModelChange)="savePreference()" scrollableNumber />
                            <label>Out</label>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 flex align-items-center justify-content-center gap-1">
        <p-button [disabled]="!camera.connected || !focuser.connected || running" label="Start" (onClick)="start()"
                  icon="mdi mdi-play" severity="success" size="small" />
        <p-button [disabled]="!camera.connected || !focuser.connected || !running" label="Abort" (onClick)="stop()"
                  icon="mdi mdi-stop" severity="danger" size="small" />
        <p-button [disabled]="!camera.connected" (onClick)="openCameraImage()" icon="mdi mdi-image" [text]="true"
                  styleClass="ml-4" pTooltip="View image" tooltipPosition="bottom" size="small" />
    </div>
</div>